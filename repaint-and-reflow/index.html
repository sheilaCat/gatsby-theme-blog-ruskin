<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.19.7"/><link as="script" rel="preload" href="/webpack-runtime-c8e201afe40dbf763c16.js"/><link as="script" rel="preload" href="/app-2a66e0ce4873d7afcdd1.js"/><link as="script" rel="preload" href="/commons-a0f01e391d553d6cad30.js"/><link as="script" rel="preload" href="/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-4436b98ef2cf8fd2fbea.js"/><link as="fetch" rel="preload" href="/page-data/repaint-and-reflow/page-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="1703l2l">body{--theme-ui-colors-text:var(--theme-ui-colors-text,hsl(10,20%,20%));--theme-ui-colors-background:var(--theme-ui-colors-background,hsl(10,10%,98%));--theme-ui-colors-primary:var(--theme-ui-colors-primary,hsl(10,80%,50%));--theme-ui-colors-secondary:var(--theme-ui-colors-secondary,hsl(10,60%,50%));--theme-ui-colors-highlight:var(--theme-ui-colors-highlight,hsl(10,40%,90%));--theme-ui-colors-purple:var(--theme-ui-colors-purple,hsl(250,60%,30%));--theme-ui-colors-muted:var(--theme-ui-colors-muted,hsl(10,20%,94%));--theme-ui-colors-gray:var(--theme-ui-colors-gray,hsl(10,20%,50%));color:var(--theme-ui-colors-text,hsl(10,20%,20%));background-color:var(--theme-ui-colors-background,hsl(10,10%,98%));}body.theme-ui-dark{--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#fff);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#000);--theme-ui-colors-primary:var(--theme-ui-colors-modes-dark-primary,#0cf);}</style><style data-emotion-css="1koeerz">*{box-sizing:border-box;}body{margin:0;font-family:"Noto Sans SC",sans-serif;line-height:1.5;font-weight:400;}</style><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><style data-emotion-css="yf41ly">.css-yf41ly{font-family:"Noto Sans SC",sans-serif;line-height:1.5;font-weight:400;}</style><div class="css-yf41ly"><style data-emotion-css="1tmsgt3">.css-1tmsgt3{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;padding-left:600px;padding-right:600px;padding-top:50px;padding-bottom:50px;}</style><div class="css-1tmsgt3"><header><style data-emotion-css="4cffwv">.css-4cffwv{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-4cffwv"><style data-emotion-css="11qjisw">.css-11qjisw{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><style data-emotion-css="mbch8p">.css-mbch8p{box-sizing:border-box;margin:0;min-width:0;padding:8px;background-color:transparent;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><div class="css-mbch8p"><svg t="1583756107024" class="icon" viewBox="0 0 1024 1024" version="1.1" pId="2832" width="32" height="32"><path d="M640 512 448 704l-102.4 19.2c0-12.8-6.4-25.6-19.2-38.4s-25.6-12.8-38.4-19.2l19.2-102.4 198.4-198.4c12.8-12.8 12.8-32 0-44.8s-32-12.8-44.8 0L256 531.2C256 537.6 249.6 544 249.6 550.4l-44.8 224c0 12.8 0 19.2 6.4 32 6.4 6.4 12.8 6.4 25.6 6.4 0 0 6.4 0 6.4 0L467.2 768c6.4 0 12.8-6.4 19.2-6.4l204.8-204.8c12.8-12.8 12.8-32 0-44.8S652.8 499.2 640 512z" pId="2833"></path><path d="M576 262.4c-12.8-12.8-32-12.8-44.8 0s-12.8 32 0 44.8l179.2 179.2c6.4 6.4 12.8 6.4 25.6 6.4s19.2 0 25.6-6.4c12.8-12.8 12.8-32 0-44.8L576 262.4z" pId="2834"></path><path d="M857.6 294.4l-134.4-134.4c-25.6-25.6-64-25.6-89.6 0L588.8 198.4C576 217.6 576 236.8 588.8 256l172.8 172.8c12.8 12.8 38.4 12.8 51.2 0L857.6 384C883.2 358.4 883.2 320 857.6 294.4z" pId="2835"></path><path d="M371.2 646.4c6.4 6.4 12.8 6.4 25.6 6.4s19.2 0 25.6-6.4l179.2-179.2c12.8-12.8 12.8-32 0-44.8s-32-12.8-44.8 0L371.2 601.6C358.4 614.4 358.4 633.6 371.2 646.4z" pId="2836"></path></svg></div><style data-emotion-css="1fsu2a7">.css-1fsu2a7{box-sizing:border-box;margin:0;min-width:0;padding:8px;background-color:transparent;}</style><div class="css-1fsu2a7"><style data-emotion-css="rqfa4z">.css-rqfa4z{box-sizing:border-box;margin:0;min-width:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:inline-block;text-align:center;line-height:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:inherit;padding-left:16px;padding-right:16px;padding-top:8px;padding-bottom:8px;color:white;background-color:var(--theme-ui-colors-primary,hsl(10,80%,50%));border:0;border-radius:4px;background-color:transparent;}</style><button style="transition:display 0.45s ease 0s" class="css-rqfa4z"><svg t="1583750266733" class="icon" viewBox="0 0 1024 1024" version="1.1" pId="3837" data-spm-anchor-id="a313x.7781069.0.i2" width="32" height="32"><path d="M512 832c-179.2 0-320-140.8-320-320s140.8-320 320-320 320 140.8 320 320S691.2 832 512 832M512 896c211.2 0 384-172.8 384-384s-172.8-384-384-384S128 300.8 128 512 300.8 896 512 896L512 896zM800 512c0-160-128-288-288-288l0 576C672 800 800 672 800 512zM480 608 243.2 608C249.6 620.8 256 640 262.4 652.8l217.6 0L480 608zM480 416 480 371.2 262.4 371.2C256 384 249.6 403.2 243.2 416L480 416zM480 300.8 480 256 384 256C358.4 268.8 339.2 281.6 320 300.8L480 300.8zM224 537.6l256 0L480 492.8l-256 0c0 6.4 0 12.8 0 19.2S224 524.8 224 537.6zM480 723.2 320 723.2c19.2 19.2 38.4 32 64 44.8l96 0L480 723.2z" pId="3838" fill="#333333" data-spm-anchor-id="a313x.7781069.0.i3" class=""></path></svg></button></div></div></header><style data-emotion-css="1yrmf69">.css-1yrmf69{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:container;margin-left:auto;margin-right:auto;}</style><div class="css-1yrmf69"><style data-emotion-css="kzpyd9">.css-kzpyd9{font-family:"Noto Serif SC",serif;font-size:24px;font-weight:900;-webkit-letter-spacing:0.01em;-moz-letter-spacing:0.01em;-ms-letter-spacing:0.01em;letter-spacing:0.01em;margin-top:16px;}@media screen and (min-width:40em){.css-kzpyd9{font-size:32px;}}</style><h1 class="css-kzpyd9">重绘与重排</h1><div style="display:flex;flex-direction:row;align-items:center"><style data-emotion-css="vuulmy">.css-vuulmy{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;border-radius:9999px;margin-left:10px;margin-right:10px;}</style><img width="26" height="48" src="data:image/png;base64,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" class="css-vuulmy"/><style data-emotion-css="1u9dch6">.css-1u9dch6{box-sizing:border-box;margin:0;min-width:0;margin-left:10px;margin-right:10px;}</style><div class="css-1u9dch6">sheila.cat</div><div>Invalid date</div><style data-emotion-css="1xeyx7d">.css-1xeyx7d{box-sizing:border-box;margin:0;min-width:0;margin-left:20px;margin-right:20px;}</style><div class="css-1xeyx7d"><span id="busuanzi_container_page_pv">本文总阅读量<span id="busuanzi_value_page_pv"></span>次</span></div></div><p class="css-0">先阅读<strong class="css-0"><em class="css-0">浏览器渲染机制</em></strong>，在浏览器渲染中会进行重绘与重排。</p><p class="css-0">先阅读<strong class="css-0"><em class="css-0">浏览器渲染机制</em></strong>，在浏览器渲染中会进行重绘与重排。</p><style data-emotion-css="b6rqkj">.css-b6rqkj{font-family:"Noto Serif SC",serif;font-size:24px;}</style><h2 id="重排与重绘" class="css-b6rqkj">重排与重绘</h2><ol class="css-0"><li class="css-0"><p class="css-0">当render tree中的一部分(或全部)因为元素的规模尺寸，布局，隐藏等改变而需要重新构建。这就称为重排(reflow)。每个页面至少需要一次重排，就是在页面第一次加载的时候。在重排的时候，浏览器会使渲染树中受到影响的部分失效，并重新构造这部分渲染树，完成重排后，浏览器会重新绘制受影响的部分到屏幕中，该过程成为重绘。</p></li><li class="css-0"><p class="css-0">当render tree中的一些元素需要更新属性，而这些属性只是影响元素的外观，风格，而不会影响布局的，比如background-color。则就叫称为重绘。</p></li></ol><p class="css-0">注意：重排必将引起重绘，而重绘不一定会引起重排。</p><h2 id="重排何时发生" class="css-b6rqkj">重排何时发生</h2><p class="css-0">当页面布局和几何属性改变时就需要重排。下述情况会发生浏览器重排：</p><ol class="css-0"><li class="css-0"><p class="css-0">添加或者删除可见的DOM元素；</p></li><li class="css-0"><p class="css-0">元素位置改变；</p></li><li class="css-0"><p class="css-0">元素尺寸改变——边距、填充、边框、宽度和高度</p></li><li class="css-0"><p class="css-0">内容改变——比如文本改变或者图片大小改变而引起的计算值宽度和高度改变；</p></li><li class="css-0"><p class="css-0">页面渲染初始化；</p></li><li class="css-0"><p class="css-0">浏览器窗口尺寸改变——resize事件发生时；</p></li></ol><p class="css-0">重排的花销跟DOM节点所处的层次有关系，层级越高，开销越大。</p><p class="css-0">以上只是简单列举了出现重排和重绘的情况，附两篇进行详尽列举的文章：</p><ul class="css-0"><li class="css-0">在JavaScript中会引起强制重排和重绘的相关属性和方法：<style data-emotion-css="ig17b7">.css-ig17b7{color:var(--theme-ui-colors-primary,hsl(10,80%,50%));}.css-ig17b7:hover{color:var(--theme-ui-colors-secondary,hsl(10,60%,50%));}</style><a href="https://gist.github.com/paulirish/5d52fb081b3570c81e3a" class="css-ig17b7">What forces layout / reflow</a></li><li class="css-0">在CSS中能触发布局、绘制或渲染层合并的属性：<a href="https://csstriggers.com/" class="css-ig17b7">csstriggers</a></li></ul><h2 id="flush队列" class="css-b6rqkj">flush队列</h2><p class="css-0">重排和重绘很容易被引起，而且重排的花销也不小，如果每句JS操作都去重排重绘的话，浏览器可能就会受不了。所以很多浏览器都会优化这些操作，浏览器会维护1个队列，把所有会引起重排、重绘的操作放入这个队列，等队列中的操作到了一定的数量或者到了一定的时间间隔，浏览器就会flush队列，进行一个批处理。这样就会让多次的重排、重绘变成一次重排重绘。</p><p class="css-0">虽然有了浏览器的优化，但有时候我们写的一些代码可能会强制浏览器提前flush队列，这样浏览器的优化可能就起不到作用了。当你请求向浏览器请求一些 style信息的时候，就会让浏览器flush队列，比如：</p><ol class="css-0"><li class="css-0"><p class="css-0">offsetTop, offsetLeft, offsetWidth, offsetHeight</p></li><li class="css-0"><p class="css-0">scrollTop/Left/Width/Height</p></li><li class="css-0"><p class="css-0">clientTop/Left/Width/Height</p></li><li class="css-0"><p class="css-0">width,height</p></li><li class="css-0"><p class="css-0">请求了getComputedStyle(), 或者 IE的 currentStyle</p></li></ol><p class="css-0">当你请求上面的一些属性的时候，浏览器为了给你最精确的值，需要flush队列，因为队列中可能会有影响到这些值的操作。即使你获取元素的布局和样式信息跟最近发生或改变的布局信息无关，浏览器都会强行刷新渲染队列。</p><h2 id="如何减少重排、重绘" class="css-b6rqkj">如何减少重排、重绘</h2><p class="css-0">减少重排、重绘其实就是需要减少对render tree的操作（合并多次多DOM和样式的修改），并减少对一些style信息的请求，尽量利用好浏览器的优化策略。具体方法有：</p><ul class="css-0"><li class="css-0"><p class="css-0">不要单独操作对DOM元素的样式修改，直接改变className，如果动态改变样式，则使用cssText（考虑没有优化的浏览器）</p></li><li class="css-0"><p class="css-0">让要操作的元素进行”离线处理”，处理完后一起更新</p><p class="css-0">  <em class="css-0">a)</em> 使用DocumentFragment进行缓存操作,引发一次重排和重绘；</p><p class="css-0">  <em class="css-0">b)</em> 使用display:none技术，只引发两次重排和重绘；</p><p class="css-0">  <em class="css-0">c)</em> 使用cloneNode(true or false) 和 replaceChild 技术，引发一次重排和重绘；</p></li><li class="css-0"><p class="css-0">将需要多次重排的元素，position属性设为absolute或fixed，这样此元素就脱离了文档流，它的变化不会影响到其他元素。例如有动画效果的元素就最好设置为绝对定位。</p></li><li class="css-0"><p class="css-0">将新建的dom节点操作完毕后在插入到body中。</p></li><li class="css-0"><p class="css-0">避免强制同步布局事件的发生：尽量不要在布局信息改变时做查询（会导致渲染队列强制刷新）。</p></li><li class="css-0"><p class="css-0">尽可能避免触发布局：</p></li></ul><style data-emotion-css="1vkibyu">.css-1vkibyu{font-family:Menlo,monospace;font-size:14px;padding:16px;color:var(--theme-ui-colors-text,hsl(10,20%,20%));background-color:var(--theme-ui-colors-muted,hsl(10,20%,94%));overflow:auto;}.css-1vkibyu .comment,.css-1vkibyu .prolog,.css-1vkibyu .doctype,.css-1vkibyu .cdata,.css-1vkibyu .punctuation,.css-1vkibyu .operator,.css-1vkibyu .entity,.css-1vkibyu .url{color:var(--theme-ui-colors-gray,hsl(10,20%,50%));}.css-1vkibyu .comment{font-style:italic;}.css-1vkibyu .property,.css-1vkibyu .tag,.css-1vkibyu .boolean,.css-1vkibyu .number,.css-1vkibyu .constant,.css-1vkibyu .symbol,.css-1vkibyu .deleted,.css-1vkibyu .function,.css-1vkibyu .class-name,.css-1vkibyu .regex,.css-1vkibyu .important,.css-1vkibyu .variable{color:var(--theme-ui-colors-purple,hsl(250,60%,30%));}.css-1vkibyu .atrule,.css-1vkibyu .attr-value,.css-1vkibyu .keyword{color:var(--theme-ui-colors-primary,hsl(10,80%,50%));}.css-1vkibyu .selector,.css-1vkibyu .attr-name,.css-1vkibyu .string,.css-1vkibyu .char,.css-1vkibyu .builtin,.css-1vkibyu .inserted{color:var(--theme-ui-colors-secondary,hsl(10,60%,50%));}.css-1vkibyu code{color:inherit;}</style><style data-emotion-css="17bd8xr">.css-17bd8xr{font-family:Menlo,monospace;color:var(--theme-ui-colors-secondary,hsl(10,60%,50%));font-size:14px;}</style><style data-emotion-css="szd2tu">.css-szd2tu{font-family:Menlo,monospace;font-size:14px;padding:16px;color:var(--theme-ui-colors-text,hsl(10,20%,20%));background-color:var(--theme-ui-colors-muted,hsl(10,20%,94%));overflow:auto;font-family:Menlo,monospace;color:var(--theme-ui-colors-secondary,hsl(10,60%,50%));font-size:14px;}.css-szd2tu .comment,.css-szd2tu .prolog,.css-szd2tu .doctype,.css-szd2tu .cdata,.css-szd2tu .punctuation,.css-szd2tu .operator,.css-szd2tu .entity,.css-szd2tu .url{color:var(--theme-ui-colors-gray,hsl(10,20%,50%));}.css-szd2tu .comment{font-style:italic;}.css-szd2tu .property,.css-szd2tu .tag,.css-szd2tu .boolean,.css-szd2tu .number,.css-szd2tu .constant,.css-szd2tu .symbol,.css-szd2tu .deleted,.css-szd2tu .function,.css-szd2tu .class-name,.css-szd2tu .regex,.css-szd2tu .important,.css-szd2tu .variable{color:var(--theme-ui-colors-purple,hsl(250,60%,30%));}.css-szd2tu .atrule,.css-szd2tu .attr-value,.css-szd2tu .keyword{color:var(--theme-ui-colors-primary,hsl(10,80%,50%));}.css-szd2tu .selector,.css-szd2tu .attr-name,.css-szd2tu .string,.css-szd2tu .char,.css-szd2tu .builtin,.css-szd2tu .inserted{color:var(--theme-ui-colors-secondary,hsl(10,60%,50%));}.css-szd2tu code{color:inherit;}</style><pre class="language-jsx:javascript prism-code language-jsx:javascript css-szd2tu"><div class="token-line"><style data-emotion-css="1baulvz">.css-1baulvz{display:inline-block;}</style><span class="token plain css-1baulvz">.box {</span></div><div class="token-line"><span class="token plain css-1baulvz">  width: 20px;</span></div><div class="token-line"><span class="token plain css-1baulvz">  height: 20px;</span></div><div class="token-line"><span class="token plain css-1baulvz">}</span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">/**</span></div><div class="token-line"><span class="token plain css-1baulvz"> * Changing width and height</span></div><div class="token-line"><span class="token plain css-1baulvz"> * triggers layout.</span></div><div class="token-line"><span class="token plain css-1baulvz"> */</span></div><div class="token-line"><span class="token plain css-1baulvz">.box--expanded {</span></div><div class="token-line"><span class="token plain css-1baulvz">  width: 200px;</span></div><div class="token-line"><span class="token plain css-1baulvz">  height: 350px;</span></div><div class="token-line"><span class="token plain css-1baulvz">}</span></div></pre><ul class="css-0"><li class="css-0"><p class="css-0">使用flexbox替代老的布局模型。</p></li><li class="css-0"><p class="css-0">避免快速连续的布局：不要经常访问会引起浏览器flush队列的属性，如果你确实要访问，利用先读后写的原则。</p></li></ul><pre class="language-javascript prism-code language-javascript css-szd2tu"><div class="token-line"><span class="token keyword css-1baulvz">function</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">resizeAllParagraphsToMatchBlockWidth</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token comment css-1baulvz">// Puts the browser into a read-write-read-write cycle.</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">for</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token keyword css-1baulvz">var</span><span class="token plain css-1baulvz"> i </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token number css-1baulvz">0</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"> i </span><span class="token operator css-1baulvz">&lt;</span><span class="token plain css-1baulvz"> paragraphs</span><span class="token punctuation css-1baulvz">.</span><span class="token property-access css-1baulvz">length</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"> i</span><span class="token operator css-1baulvz">++</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    paragraphs</span><span class="token punctuation css-1baulvz">[</span><span class="token plain css-1baulvz">i</span><span class="token punctuation css-1baulvz">]</span><span class="token punctuation css-1baulvz">.</span><span class="token property-access css-1baulvz">style</span><span class="token punctuation css-1baulvz">.</span><span class="token property-access css-1baulvz">width</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> box</span><span class="token punctuation css-1baulvz">.</span><span class="token property-access css-1baulvz">offsetWidth</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz">+</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&#x27;px&#x27;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span></div></pre><p class="css-0">我们使用<style data-emotion-css="8koc4y">.css-8koc4y{font-family:Menlo,monospace;color:var(--theme-ui-colors-secondary,hsl(10,60%,50%));background-color:var(--theme-ui-colors-muted,hsl(10,20%,94%));}</style><code class="css-8koc4y">先读后写</code>的原则，来修复上述代码中的问题：</p><pre class="language-javascript prism-code language-javascript css-szd2tu"><div class="token-line"><span class="token comment css-1baulvz">// Read.</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz">var</span><span class="token plain css-1baulvz"> width </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> box</span><span class="token punctuation css-1baulvz">.</span><span class="token property-access css-1baulvz">offsetWidth</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token keyword css-1baulvz">function</span><span class="token plain css-1baulvz"> </span><span class="token function css-1baulvz">resizeAllParagraphsToMatchBlockWidth</span><span class="token punctuation css-1baulvz">(</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token keyword css-1baulvz">for</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">(</span><span class="token keyword css-1baulvz">var</span><span class="token plain css-1baulvz"> i </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> </span><span class="token number css-1baulvz">0</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"> i </span><span class="token operator css-1baulvz">&lt;</span><span class="token plain css-1baulvz"> paragraphs</span><span class="token punctuation css-1baulvz">.</span><span class="token property-access css-1baulvz">length</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"> i</span><span class="token operator css-1baulvz">++</span><span class="token punctuation css-1baulvz">)</span><span class="token plain css-1baulvz"> </span><span class="token punctuation css-1baulvz">{</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    </span><span class="token comment css-1baulvz">// Now write.</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">    paragraphs</span><span class="token punctuation css-1baulvz">[</span><span class="token plain css-1baulvz">i</span><span class="token punctuation css-1baulvz">]</span><span class="token punctuation css-1baulvz">.</span><span class="token property-access css-1baulvz">style</span><span class="token punctuation css-1baulvz">.</span><span class="token property-access css-1baulvz">width</span><span class="token plain css-1baulvz"> </span><span class="token operator css-1baulvz">=</span><span class="token plain css-1baulvz"> width </span><span class="token operator css-1baulvz">+</span><span class="token plain css-1baulvz"> </span><span class="token string css-1baulvz">&#x27;px&#x27;</span><span class="token punctuation css-1baulvz">;</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz">  </span><span class="token punctuation css-1baulvz">}</span><span class="token plain css-1baulvz"></span></div><div class="token-line"><span class="token plain css-1baulvz"></span><span class="token punctuation css-1baulvz">}</span></div></pre><style data-emotion-css="579nbd">.css-579nbd{font-family:"Noto Serif SC",serif;font-size:20px;}</style><h4 id="引用：" class="css-579nbd">引用：</h4><p class="css-0"><a href="http://www.css88.com/archives/4996" class="css-ig17b7">页面重绘和回流以及优化</a></p><p class="css-0"><a href="http://www.cnblogs.com/zichi/p/4720000.html" class="css-ig17b7">高性能JavaScript 重排与重绘</a></p><p class="css-0"><a href="http://www.phpied.com/rendering-repaint-reflowrelayout-restyle/" class="css-ig17b7">Rendering: repaint, reflow/relayout, restyle</a></p><p class="css-0"><a href="https://developers.google.com/web/fundamentals/performance/rendering/avoid-large-complex-layouts-and-layout-thrashing?hl=en" class="css-ig17b7">Avoid large, complex layouts and layout thrashing
</a></p><p class="css-0"><a href="https://developers.google.com/web/fundamentals/performance/rendering/avoid-large-complex-layouts-and-layout-thrashing?hl=ch" class="css-ig17b7">中文翻译 避免大规模、复杂的布局
</a></p><h4 id="推荐阅读：" class="css-579nbd">推荐阅读：</h4><p class="css-0"><a href="http://www.ruanyifeng.com/blog/2015/09/web-page-performance-in-depth.html" class="css-ig17b7">网页性能管理详解</a></p><blockquote class="css-0"><p class="css-0">这篇文章讲到了使用<code class="css-8koc4y">window.requestAnimationFrame()</code>和<code class="css-8koc4y">window.requestIdleCallback()</code>来调节浏览器重新渲染的时间点。</p></blockquote><blockquote class="css-0"><p class="css-0">另外，这篇文章中，所提到的，不要在写操作之后紧跟一个读操作。也就是<code class="css-8koc4y">flush队列</code>中提到的，本来是会攒一堆重绘重排操作，但紧跟一个读操作之后，为了给你一个准确值，就会立即进行重绘重排。</p></blockquote><script src="https://utteranc.es/client.js" repo="https://github.com/sheilaCat/blog" issue-term="title" label="comment" theme="github-light" crossorigin="anonymous" async=""></script></div><style data-emotion-css="1sak88m">.css-1sak88m{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-gray,hsl(10,20%,50%));margin:0;margin-top:8px;margin-bottom:8px;border:0;border-bottom:1px solid;border:0;border-bottom:1px solid;border-color:var(--theme-ui-colors-muted,hsl(10,20%,94%));}</style><hr class="css-1sak88m"/><script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv">本站访客数<span id="busuanzi_value_site_uv"></span>人次</span><div>© sheilaCat 2019-2020</div></div></div></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/repaint-and-reflow/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-2a66e0ce4873d7afcdd1.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-4436b98ef2cf8fd2fbea.js"],"component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js":["/component---node-modules-gatsby-theme-blog-core-src-templates-posts-query-js-be33e3aab0a9b6f419f3.js"]};/*]]>*/</script><script src="/component---node-modules-gatsby-theme-blog-core-src-templates-post-query-js-4436b98ef2cf8fd2fbea.js" async=""></script><script src="/commons-a0f01e391d553d6cad30.js" async=""></script><script src="/app-2a66e0ce4873d7afcdd1.js" async=""></script><script src="/webpack-runtime-c8e201afe40dbf763c16.js" async=""></script></body></html>